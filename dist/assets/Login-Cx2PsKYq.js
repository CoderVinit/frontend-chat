import{j as e,r as I,u as S,S as W,V as H,a as b,b as w,_ as m}from"./index-BRYrtOYy.js";import{i as L,u as p,a as V}from"./index-DdwGzNOV.js";import{C as A}from"./Container-Dfe32-CX.js";import{c as D,P as F,T as s,M as q}from"./Modal-CADgA5Of.js";import{T as i}from"./TextField-CUotFnna.js";import{B as h}from"./Button-CgSTDiwQ.js";import{A as R}from"./Menu-Cy-i2GGQ.js";import"./isMuiElement-DvTSXCug.js";const k=D([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt"),M=u=>{if(!L(u))return{isValid:!1,errorMessage:"Invalid username"}},J=()=>{const[u,y]=I.useState(!0),g=p(""),x=p(""),a=p("",M),t=p(""),o=V("single"),f=S(),C=async v=>{var d,l;v.preventDefault();const r={withCredentials:!0,headers:{"Content-Type":"application/json"}};try{const{data:n}=await b.post("http://localhost:4000/api/v1/users/login",{username:a.value,password:t.value},r);f(w(!0)),m.success(n.message)}catch(n){m.error(((l=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:l.message)||"Something went wrong")}},T=async v=>{var l,n;v.preventDefault();const r=new FormData;r.append("avatar",o.file),r.append("name",g.value),r.append("username",a.value),r.append("password",t.value),r.append("bio",x.value);const d={withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}};try{const{data:c}=await b.post("http://localhost:4000/api/v1/users/new",r,d);f(w(!0)),m.success(c.message)}catch(c){m.error(((n=(l=c==null?void 0:c.response)==null?void 0:l.data)==null?void 0:n.message)||"Something went wrong")}},j=()=>{y(!u)};return e.jsx(A,{component:"main",maxWidth:"xs",sx:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(F,{elevation:3,sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center"},children:u?e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"h5",children:"Sign In"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:C,children:[e.jsx(i,{label:"username",value:a.value,onChange:a.changeHandler,fullWidth:!0,required:!0,margin:"normal",variant:"outlined"}),e.jsx(i,{label:"password",value:t.value,onChange:t.changeHandler,type:"password",fullWidth:!0,required:!0,margin:"normal",variant:"outlined"}),e.jsx(h,{sx:{marginTop:"1rem"},fullWidth:!0,variant:"contained",color:"primary",type:"submit",children:"Login"}),e.jsx(s,{sx:{textAlign:"center",marginTop:2},children:"OR"}),e.jsx(h,{sx:{marginTop:"1rem"},fullWidth:!0,variant:"text",onClick:j,children:"Register"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"h5",children:"Register"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:T,children:[e.jsxs(W,{position:"relative",width:"10rem",margin:"auto",children:[e.jsx(R,{sx:{height:"10rem",width:"10rem"},objectfit:"contain",src:o.preview}),e.jsx(q,{sx:{position:"absolute",bottom:"0",right:"0",color:"#fff",bgcolor:"rgba(0,0,0,0.5)",":hover":{bgcolor:"rgba(0,0,0,0.7)"}},component:"label",children:e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsx(H,{type:"file",onChange:o.changeHandler})]})})]}),o.error&&e.jsx(s,{m:"1rem auto",width:"fit-content",display:"block",color:"error",variant:"caption",children:o.error}),e.jsx(i,{label:"name",value:g.value,onChange:g.changeHandler,fullWidth:!0,required:!0,margin:"normal",variant:"outlined"}),e.jsx(i,{label:"username",value:a.value,onChange:a.changeHandler,fullWidth:!0,required:!0,margin:"normal",variant:"outlined"}),a.error&&e.jsx(s,{color:"error",variant:"caption",children:a.error}),e.jsx(i,{label:"bio",value:x.value,onChange:x.changeHandler,fullWidth:!0,margin:"normal",variant:"outlined"}),e.jsx(i,{label:"password",value:t.value,onChange:t.changeHandler,type:"password",fullWidth:!0,required:!0,margin:"normal",variant:"outlined"}),e.jsx(h,{sx:{marginTop:"1rem"},fullWidth:!0,variant:"contained",color:"primary",type:"submit",children:"SignUp"}),e.jsx(s,{sx:{textAlign:"center",marginTop:2},children:"OR"}),e.jsx(h,{fullWidth:!0,sx:{marginTop:"1rem"},variant:"text",onClick:j,children:"Login"})]})]})})})};export{J as default};
